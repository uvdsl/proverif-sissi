\begin{msc}
    [
    small values, 
    left environment distance=1.5cm, 
    right environment distance=2cm, 
    instance distance=3.5cm
    ]{VC-based Authentication}
    
    \declinst{issuer}{Issuer}{University}
    \declinst{holder}{Holder}{Student}
    \declinst{verifier}{Verifier}{Professor's Pod}
    
    % PROVER - n_p -> VERIFIER
    \action*{\textit{new} $n_P,sk^S_P$}{holder}
    \nextlevel
    \nextlevel
    \mess{$\{\{(n_P, pk^{S}_{P})\}_{sk^{S}_{P}}\}_{pk^{L}_{V}}$}{holder}{verifier}
    \nextlevel
    
    % VERIFIER - n_v -> PROVER
    \action*{\textit{new} $n_V,sk^S_V$}{verifier}
    \nextlevel
    \nextlevel
    \mess{$\{\{(n_P, n_V pk^{S}_{V})\}_{sk^{L}_{V}}\}_{pk^{S}_{P}}$}{verifier}{holder}
    \nextlevel
    
    % PROVER - u -> VERIFIER
    \action*{\textit{if} $n_P == n'_P$}{holder}
    \nextlevel
    \nextlevel
    \mess{$\{\{(n_V, u)\}_{sk^{S}_{P}}\}_{pk^{S}_{V}}$}{holder}{verifier}
    \nextlevel
    
    % VERIFIER - n_c -> PROVER
    \action*{\textit{if} $n_V == n'_V$}{verifier}
    \nextlevel
    \nextlevel
    \action*{\textit{new} $n_c$}{verifier}
    \nextlevel
    \nextlevel
    \mess{$\{\{(n_c, r)\}_{sk^{S}_{V}}\}_{pk^{S}_{P}}$}{verifier}{holder}
    \nextlevel
    
    % PROVER - VP -> VERIFIER
    \action*{$VP = \{(n_c,V,c)\}_{sk^{L}_{P}}$}{holder}
    \nextlevel
    \nextlevel
    \mess{$\{\{VP\}_{sk^{S}_{P}}\}_{pk^{S}_{V}}$}{holder}{verifier}
    \nextlevel
    
    % VERIFIER - access_token -> PROVER
    \action*{\textit{if} $snd(VP) == V$}{verifier}
    \nextlevel
    \nextlevel
    \action*{\textit{if} $auth(VP)$}{verifier}
    \nextlevel
    \nextlevel
    \action*{\textit{if} $n_c == n'_c$}{verifier}
    \nextlevel
    \nextlevel
    \action*{\textit{if} $auth(c)$}{verifier}
    \nextlevel
    \nextlevel
    \action*{\textit{if} $match(c,r)$}{verifier}
    \nextlevel
    \nextlevel
    \action*{\textit{new} $tkn_{access}$}{verifier}
    \nextlevel
    \nextlevel
    \mess{$\{\{(tkn_{access}, P)\}_{sk^{S}_{V}}\}_{pk^{S}_{P}}$}{verifier}{holder}
    \nextlevel
    
    % PROVER 
    \action*{\textit{if} $snd(msg) == P$}{holder}
    \nextlevel
    
    
    \end{msc}
    